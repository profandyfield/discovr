
R version 4.5.1 (2025-06-13) -- "Great Square Root"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "modelbased"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> library('modelbased')
> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("as.data.frame.estimate_contrasts")
> ### * as.data.frame.estimate_contrasts
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: as.data.frame.estimate_contrasts
> ### Title: Converting modelbased-objects into raw data frames
> ### Aliases: as.data.frame.estimate_contrasts
> 
> ### ** Examples
> 
> ## Don't show: 
> if (insight::check_if_installed("marginaleffects", quietly = TRUE)) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ model <- lm(Petal.Length ~ Species, data = iris)
+ out <- estimate_means(model, "Species")
+ 
+ # default
+ print(out)
+ 
+ as.data.frame(out)
+ 
+ as.data.frame(out, preserve_names = FALSE)
+ 
+ as.data.frame(out, preserve_names = FALSE, use_responsename = TRUE)
+ ## Don't show: 
+ }) # examplesIf
> model <- lm(Petal.Length ~ Species, data = iris)
> out <- estimate_means(model, "Species")
> print(out)
[34mEstimated Marginal Means[39m

Species    | Mean |   SE |       95% CI | t(147)
------------------------------------------------
setosa     | 1.46 | 0.06 | [1.34, 1.58] |  24.02
versicolor | 4.26 | 0.06 | [4.14, 4.38] |  70.00
virginica  | 5.55 | 0.06 | [5.43, 5.67] |  91.23
[33m
Variable predicted: Petal.Length
Predictors modulated: Species
[39m> as.data.frame(out)
     Species  Mean         SE   CI_low  CI_high        t  df
1     setosa 1.462 0.06085848 1.341729 1.582271 24.02294 147
2 versicolor 4.260 0.06085849 4.139729 4.380271 69.99846 147
3  virginica 5.552 0.06085848 5.431729 5.672271 91.22804 147
> as.data.frame(out, preserve_names = FALSE)
     Species Coefficient         SE   CI_low  CI_high        t  df
1     setosa       1.462 0.06085848 1.341729 1.582271 24.02294 147
2 versicolor       4.260 0.06085849 4.139729 4.380271 69.99846 147
3  virginica       5.552 0.06085848 5.431729 5.672271 91.22804 147
> as.data.frame(out, preserve_names = FALSE, use_responsename = TRUE)
     Species Petal.Length         SE   CI_low  CI_high        t  df
1     setosa        1.462 0.06085848 1.341729 1.582271 24.02294 147
2 versicolor        4.260 0.06085849 4.139729 4.380271 69.99846 147
3  virginica        5.552 0.06085848 5.431729 5.672271 91.22804 147
> ## End(Don't show)
> 
> 
> 
> cleanEx()
> nameEx("describe_nonlinear")
> ### * describe_nonlinear
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: describe_nonlinear
> ### Title: Describe the smooth term (for GAMs) or non-linear predictors
> ### Aliases: describe_nonlinear describe_nonlinear.data.frame
> ###   estimate_smooth
> 
> ### ** Examples
> 
> ## Don't show: 
> if (insight::check_if_installed("performance", quietly = TRUE)) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ # Create data
+ data <- data.frame(x = rnorm(200))
+ data$y <- data$x^2 + rnorm(200, 0, 0.5)
+ 
+ model <<- lm(y ~ poly(x, 2), data = data)
+ link_data <- estimate_relation(model, length = 100)
+ 
+ describe_nonlinear(link_data, x = "x")
+ ## Don't show: 
+ }) # examplesIf
> data <- data.frame(x = rnorm(200))
> data$y <- data$x^2 + rnorm(200, 0, 0.5)
> model <<- lm(y ~ poly(x, 2), data = data)
> link_data <- estimate_relation(model, length = 100)
> describe_nonlinear(link_data, x = "x")
Start |   End | Length | Change | Slope |   R2
----------------------------------------------
-2.21 | -0.02 |   0.47 |  -5.14 | -2.34 | 0.02
-0.02 |  2.40 |   0.52 |   5.93 |  2.45 | 0.02
> ## End(Don't show)
> 
> 
> 
> cleanEx()
> nameEx("estimate_contrasts")
> ### * estimate_contrasts
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: estimate_contrasts
> ### Title: Estimate Marginal Contrasts
> ### Aliases: estimate_contrasts estimate_contrasts.default
> 
> ### ** Examples
> 
> ## Don't show: 
> if (all(insight::check_if_installed(c("lme4", "marginaleffects", "parameters", "rstanarm"), quietly = TRUE))) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ ## Not run: 
+ ##D # Basic usage --------------------------------
+ ##D # --------------------------------------------
+ ##D 
+ ##D model <- lm(Sepal.Width ~ Species, data = iris)
+ ##D estimate_contrasts(model)
+ ##D 
+ ##D # Dealing with interactions
+ ##D model <- lm(Sepal.Width ~ Species * Petal.Width, data = iris)
+ ##D 
+ ##D # By default: selects first factor
+ ##D estimate_contrasts(model)
+ ##D 
+ ##D # Can also run contrasts between points of numeric, stratified by "Species"
+ ##D estimate_contrasts(model, contrast = "Petal.Width", by = "Species")
+ ##D 
+ ##D # Or both
+ ##D estimate_contrasts(model, contrast = c("Species", "Petal.Width"), length = 2)
+ ##D 
+ ##D # Or with custom specifications
+ ##D estimate_contrasts(model, contrast = c("Species", "Petal.Width = c(1, 2)"))
+ ##D 
+ ##D # Or modulate it
+ ##D estimate_contrasts(model, by = "Petal.Width", length = 4)
+ ##D 
+ ##D # Standardized differences
+ ##D estimated <- estimate_contrasts(lm(Sepal.Width ~ Species, data = iris))
+ ##D standardize(estimated)
+ ##D 
+ ##D # contrasts of slopes ------------------------
+ ##D # --------------------------------------------
+ ##D 
+ ##D data(qol_cancer, package = "parameters")
+ ##D qol_cancer$ID <- as.numeric(qol_cancer$ID)
+ ##D qol_cancer$grp <- as.factor(ifelse(qol_cancer$ID < 100, "Group 1", "Group 2"))
+ ##D model <- lm(QoL ~ time * education * grp, data = qol_cancer)
+ ##D 
+ ##D # "time" only has integer values and few values, so it's treated like a factor
+ ##D estimate_contrasts(model, "time", by = "education")
+ ##D 
+ ##D # we set `integer_as_continuous = TRUE` to treat integer as continuous
+ ##D estimate_contrasts(model, "time", by = "education", integer_as_continuous = 1)
+ ##D 
+ ##D # pairwise comparisons for multiple groups
+ ##D estimate_contrasts(
+ ##D   model,
+ ##D   "time",
+ ##D   by = c("education", "grp"),
+ ##D   integer_as_continuous = TRUE
+ ##D )
+ ##D 
+ ##D # if we want pairwise comparisons only for one factor, but group by another,
+ ##D # we need the formula specification and define the grouping variable after
+ ##D # the vertical bar
+ ##D estimate_contrasts(
+ ##D   model,
+ ##D   "time",
+ ##D   by = c("education", "grp"),
+ ##D   comparison = ~pairwise | grp,
+ ##D   integer_as_continuous = TRUE
+ ##D )
+ ##D 
+ ##D # custom factor contrasts - contrasts the average effects of two levels
+ ##D # against the remaining third level
+ ##D # ---------------------------------------------------------------------
+ ##D 
+ ##D data(puppy_love, package = "modelbased")
+ ##D cond_tx <- cbind("no treatment" = c(1, 0, 0), "treatment" = c(0, 0.5, 0.5))
+ ##D model <- lm(happiness ~ puppy_love * dose, data = puppy_love)
+ ##D estimate_slopes(model, "puppy_love", by = "dose", comparison = cond_tx)
+ ##D 
+ ##D # Other models (mixed, Bayesian, ...) --------
+ ##D # --------------------------------------------
+ ##D data <- iris
+ ##D data$Petal.Length_factor <- ifelse(data$Petal.Length < 4.2, "A", "B")
+ ##D 
+ ##D model <- lme4::lmer(Sepal.Width ~ Species + (1 | Petal.Length_factor), data = data)
+ ##D estimate_contrasts(model)
+ ##D 
+ ##D data <- mtcars
+ ##D data$cyl <- as.factor(data$cyl)
+ ##D data$am <- as.factor(data$am)
+ ##D 
+ ##D model <- rstanarm::stan_glm(mpg ~ cyl * wt, data = data, refresh = 0)
+ ##D estimate_contrasts(model)
+ ##D estimate_contrasts(model, by = "wt", length = 4)
+ ##D 
+ ##D model <- rstanarm::stan_glm(
+ ##D   Sepal.Width ~ Species + Petal.Width + Petal.Length,
+ ##D   data = iris,
+ ##D   refresh = 0
+ ##D )
+ ##D estimate_contrasts(model, by = "Petal.Length = [sd]", test = "bf")
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
> ## End(Don't show)
> 
> 
> 
> cleanEx()
> nameEx("estimate_expectation")
> ### * estimate_expectation
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: estimate_expectation
> ### Title: Model-based predictions
> ### Aliases: estimate_expectation estimate_link estimate_prediction
> ###   estimate_relation
> 
> ### ** Examples
> 
> ## Don't show: 
> if (all(insight::check_if_installed(c("see", "glmmTMB", "rstanarm"), quietly = TRUE))) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ library(modelbased)
+ 
+ # Linear Models
+ model <- lm(mpg ~ wt, data = mtcars)
+ 
+ # Get predicted and prediction interval (see insight::get_predicted)
+ estimate_expectation(model)
+ 
+ # Get expected values with confidence interval
+ pred <- estimate_relation(model)
+ pred
+ 
+ # Visualisation (see visualisation_recipe())
+ plot(pred)
+ 
+ # Standardize predictions
+ pred <- estimate_relation(lm(mpg ~ wt + am, data = mtcars))
+ z <- standardize(pred, include_response = FALSE)
+ z
+ unstandardize(z, include_response = FALSE)
+ 
+ # Logistic Models
+ model <- glm(vs ~ wt, data = mtcars, family = "binomial")
+ estimate_expectation(model)
+ estimate_relation(model)
+ 
+ # Mixed models
+ data(mtcars)
+ mtcars$gear <- as.factor(mtcars$gear)
+ model <- glmmTMB::glmmTMB(mpg ~ wt + (1 | gear), data = mtcars)
+ estimate_expectation(model)
+ estimate_relation(model)
+ 
+ # Predict random effects and calculate contrasts
+ estim <- estimate_relation(model, by = "gear")
+ estim
+ 
+ estimate_contrasts(estim)
+ 
+ # Bayesian models
+ ## Don't show: 
+ }) # examplesIf
Warning in check_dep_version(dep_pkg = "TMB") :
  package version mismatch: 
glmmTMB was built with TMB package version 1.9.17
Current TMB package version is 1.9.19
Please re-install glmmTMB from source or restore original â€˜TMBâ€™ package (see '?reinstalling' for more information)
> library(modelbased)
> model <- lm(mpg ~ wt, data = mtcars)
> estimate_expectation(model)
[34mModel-based Predictions[39m

wt   | Predicted |   SE |         95% CI | Residuals
----------------------------------------------------
2.62 |     23.28 | 0.63 | [21.99, 24.58] |     -2.28
2.88 |     21.92 | 0.57 | [20.75, 23.09] |     -0.92
2.32 |     24.89 | 0.74 | [23.38, 26.39] |     -2.09
3.21 |     20.10 | 0.54 | [19.00, 21.20] |      1.30
3.44 |     18.90 | 0.55 | [17.77, 20.03] |     -0.20
3.46 |     18.79 | 0.56 | [17.66, 19.93] |     -0.69
3.57 |     18.21 | 0.57 | [17.03, 19.38] |     -3.91
3.19 |     20.24 | 0.54 | [19.14, 21.34] |      4.16
3.15 |     20.45 | 0.54 | [19.35, 21.55] |      2.35
3.44 |     18.90 | 0.55 | [17.77, 20.03] |      0.30
3.44 |     18.90 | 0.55 | [17.77, 20.03] |     -1.10
4.07 |     15.53 | 0.72 | [14.06, 17.00] |      0.87
3.73 |     17.35 | 0.61 | [16.10, 18.60] |     -0.05
3.78 |     17.08 | 0.62 | [15.81, 18.36] |     -1.88
5.25 |      9.23 | 1.26 | [ 6.66, 11.80] |      1.17
5.42 |      8.30 | 1.35 | [ 5.55, 11.05] |      2.10
5.34 |      8.72 | 1.31 | [ 6.05, 11.39] |      5.98
2.20 |     25.53 | 0.78 | [23.93, 27.13] |      6.87
1.61 |     28.65 | 1.05 | [26.52, 30.79] |      1.75
1.83 |     27.48 | 0.94 | [25.55, 29.40] |      6.42
2.46 |     24.11 | 0.68 | [22.72, 25.51] |     -2.61
3.52 |     18.47 | 0.56 | [17.32, 19.63] |     -2.97
3.44 |     18.93 | 0.55 | [17.80, 20.05] |     -3.73
3.84 |     16.76 | 0.64 | [15.45, 18.07] |     -3.46
3.85 |     16.74 | 0.64 | [15.42, 18.05] |      2.46
1.94 |     26.94 | 0.90 | [25.11, 28.77] |      0.36
2.14 |     25.85 | 0.81 | [24.20, 27.50] |      0.15
1.51 |     29.20 | 1.09 | [26.96, 31.43] |      1.20
3.17 |     20.34 | 0.54 | [19.24, 21.44] |     -4.54
2.77 |     22.48 | 0.59 | [21.27, 23.69] |     -2.78
3.57 |     18.21 | 0.57 | [17.03, 19.38] |     -3.21
2.78 |     22.43 | 0.59 | [21.22, 23.64] |     -1.03
[33m
Variable predicted: mpg
[39m> pred <- estimate_relation(model)
> pred
[34mModel-based Predictions[39m

wt   | Predicted |   SE |         95% CI
----------------------------------------
1.51 |     29.20 | 1.09 | [26.96, 31.43]
1.95 |     26.87 | 0.89 | [25.05, 28.69]
2.38 |     24.55 | 0.71 | [23.10, 26.01]
2.82 |     22.23 | 0.58 | [21.04, 23.42]
3.25 |     19.91 | 0.54 | [18.81, 21.01]
3.69 |     17.59 | 0.60 | [16.36, 18.81]
4.12 |     15.27 | 0.74 | [13.76, 16.77]
4.55 |     12.94 | 0.92 | [11.06, 14.82]
4.99 |     10.62 | 1.13 | [ 8.32, 12.92]
5.42 |      8.30 | 1.35 | [ 5.55, 11.05]
[33m
Variable predicted: mpg
Predictors modulated: wt
[39m> plot(pred)
> pred <- estimate_relation(lm(mpg ~ wt + am, data = mtcars))
> z <- standardize(pred, include_response = FALSE)
> z
[34mModel-based Predictions (standardized)[39m

wt    |    am | Predicted |   SE |         95% CI
-------------------------------------------------
-1.74 | -0.81 |     29.22 | 1.91 | [25.31, 33.14]
-1.30 | -0.81 |     26.89 | 1.60 | [23.62, 30.17]
-0.85 | -0.81 |     24.57 | 1.30 | [21.90, 27.24]
-0.41 | -0.81 |     22.24 | 1.03 | [20.13, 24.36]
0.03  | -0.81 |     19.92 | 0.82 | [18.24, 21.60]
0.48  | -0.81 |     17.59 | 0.71 | [16.13, 19.05]
0.92  | -0.81 |     15.27 | 0.76 | [13.71, 16.83]
1.37  | -0.81 |     12.94 | 0.94 | [11.01, 14.87]
1.81  | -0.81 |     10.62 | 1.20 | [ 8.17, 13.06]
2.26  | -0.81 |      8.29 | 1.49 | [ 5.25, 11.33]
-1.74 |  1.19 |     29.20 | 1.11 | [26.92, 31.48]
-1.30 |  1.19 |     26.87 | 0.93 | [24.96, 28.78]
-0.85 |  1.19 |     24.55 | 0.86 | [22.79, 26.31]
-0.41 |  1.19 |     22.22 | 0.92 | [20.34, 24.09]
0.03  |  1.19 |     19.90 | 1.08 | [17.68, 22.11]
0.48  |  1.19 |     17.57 | 1.32 | [14.86, 20.27]
0.92  |  1.19 |     15.24 | 1.60 | [11.98, 18.51]
1.37  |  1.19 |     12.92 | 1.90 | [ 9.04, 16.79]
1.81  |  1.19 |     10.59 | 2.21 | [ 6.08, 15.11]
2.26  |  1.19 |      8.26 | 2.53 | [ 3.10, 13.43]
[33m
Variable predicted: mpg
Predictors modulated: wt, am
[39m> unstandardize(z, include_response = FALSE)
[34mModel-based Predictions (standardized)[39m

wt   | am | Predicted |   SE |         95% CI
---------------------------------------------
1.51 |  0 |     29.22 | 1.91 | [25.31, 33.14]
1.95 |  0 |     26.89 | 1.60 | [23.62, 30.17]
2.38 |  0 |     24.57 | 1.30 | [21.90, 27.24]
2.82 |  0 |     22.24 | 1.03 | [20.13, 24.36]
3.25 |  0 |     19.92 | 0.82 | [18.24, 21.60]
3.69 |  0 |     17.59 | 0.71 | [16.13, 19.05]
4.12 |  0 |     15.27 | 0.76 | [13.71, 16.83]
4.55 |  0 |     12.94 | 0.94 | [11.01, 14.87]
4.99 |  0 |     10.62 | 1.20 | [ 8.17, 13.06]
5.42 |  0 |      8.29 | 1.49 | [ 5.25, 11.33]
1.51 |  1 |     29.20 | 1.11 | [26.92, 31.48]
1.95 |  1 |     26.87 | 0.93 | [24.96, 28.78]
2.38 |  1 |     24.55 | 0.86 | [22.79, 26.31]
2.82 |  1 |     22.22 | 0.92 | [20.34, 24.09]
3.25 |  1 |     19.90 | 1.08 | [17.68, 22.11]
3.69 |  1 |     17.57 | 1.32 | [14.86, 20.27]
4.12 |  1 |     15.24 | 1.60 | [11.98, 18.51]
4.55 |  1 |     12.92 | 1.90 | [ 9.04, 16.79]
4.99 |  1 |     10.59 | 2.21 | [ 6.08, 15.11]
5.42 |  1 |      8.26 | 2.53 | [ 3.10, 13.43]
[33m
Variable predicted: mpg
Predictors modulated: wt, am
[39m> model <- glm(vs ~ wt, data = mtcars, family = "binomial")
> estimate_expectation(model)
[34mModel-based Predictions[39m

wt   | Predicted |   SE |       95% CI | Residuals
--------------------------------------------------
2.62 |      0.67 | 0.12 | [0.40, 0.86] |     -0.67
2.88 |      0.56 | 0.12 | [0.33, 0.76] |     -0.56
2.32 |      0.78 | 0.12 | [0.47, 0.94] |      0.22
3.21 |      0.39 | 0.11 | [0.21, 0.61] |      0.61
3.44 |      0.30 | 0.11 | [0.14, 0.53] |     -0.30
3.46 |      0.29 | 0.10 | [0.13, 0.53] |      0.71
3.57 |      0.25 | 0.10 | [0.10, 0.50] |     -0.25
3.19 |      0.41 | 0.11 | [0.22, 0.62] |      0.59
3.15 |      0.42 | 0.11 | [0.24, 0.64] |      0.58
3.44 |      0.30 | 0.11 | [0.14, 0.53] |      0.70
3.44 |      0.30 | 0.11 | [0.14, 0.53] |      0.70
4.07 |      0.11 | 0.08 | [0.02, 0.39] |     -0.11
3.73 |      0.20 | 0.10 | [0.07, 0.46] |     -0.20
3.78 |      0.18 | 0.10 | [0.06, 0.45] |     -0.18
5.25 |      0.01 | 0.02 | [0.00, 0.24] |     -0.01
5.42 |  9.49e-03 | 0.02 | [0.00, 0.23] | -9.49e-03
5.34 |      0.01 | 0.02 | [0.00, 0.23] |     -0.01
2.20 |      0.82 | 0.12 | [0.49, 0.96] |      0.18
1.61 |      0.93 | 0.07 | [0.58, 0.99] |      0.07
1.83 |      0.90 | 0.09 | [0.55, 0.99] |      0.10
2.46 |      0.73 | 0.13 | [0.44, 0.91] |      0.27
3.52 |      0.27 | 0.10 | [0.11, 0.51] |     -0.27
3.44 |      0.30 | 0.11 | [0.14, 0.53] |     -0.30
3.84 |      0.16 | 0.10 | [0.05, 0.43] |     -0.16
3.85 |      0.16 | 0.10 | [0.05, 0.43] |     -0.16
1.94 |      0.88 | 0.10 | [0.54, 0.98] |      0.12
2.14 |      0.84 | 0.11 | [0.50, 0.96] |     -0.84
1.51 |      0.94 | 0.07 | [0.60, 0.99] |      0.06
3.17 |      0.42 | 0.11 | [0.23, 0.63] |     -0.42
2.77 |      0.60 | 0.12 | [0.36, 0.80] |     -0.60
3.57 |      0.25 | 0.10 | [0.10, 0.50] |     -0.25
2.78 |      0.60 | 0.12 | [0.36, 0.80] |      0.40
[33m
Variable predicted: vs
Predictions are on the response-scale.
[39m> estimate_relation(model)
[34mModel-based Predictions[39m

wt   | Predicted |   SE |       95% CI
--------------------------------------
1.51 |      0.94 | 0.07 | [0.60, 0.99]
1.95 |      0.88 | 0.10 | [0.53, 0.98]
2.38 |      0.76 | 0.12 | [0.46, 0.92]
2.82 |      0.58 | 0.12 | [0.35, 0.78]
3.25 |      0.38 | 0.11 | [0.20, 0.60]
3.69 |      0.21 | 0.10 | [0.07, 0.47]
4.12 |      0.10 | 0.08 | [0.02, 0.38]
4.55 |      0.05 | 0.05 | [0.01, 0.32]
4.99 |      0.02 | 0.03 | [0.00, 0.27]
5.42 |  9.49e-03 | 0.02 | [0.00, 0.23]
[33m
Variable predicted: vs
Predictors modulated: wt
Predictions are on the response-scale.
[39m> data(mtcars)
> mtcars$gear <- as.factor(mtcars$gear)
> model <- glmmTMB::glmmTMB(mpg ~ wt + (1 | gear), data = mtcars)
> estimate_expectation(model)
[34mModel-based Predictions[39m

wt   | gear | Predicted |   SE |         95% CI | Residuals
-----------------------------------------------------------
2.62 | 4    |     23.64 | 1.08 | [21.53, 25.76] |     -2.64
2.88 | 4    |     22.32 | 1.13 | [20.11, 24.53] |     -1.32
2.32 | 4    |     25.20 | 1.05 | [23.14, 27.26] |     -2.40
3.21 | 3    |     19.87 | 0.81 | [18.28, 21.46] |      1.53
3.44 | 3    |     18.70 | 0.75 | [17.23, 20.18] | -1.00e-03
3.46 | 3    |     18.60 | 0.75 | [17.13, 20.06] |     -0.50
3.57 | 3    |     18.03 | 0.73 | [16.60, 19.46] |     -3.73
3.19 | 4    |     20.68 | 1.22 | [18.29, 23.08] |      3.72
3.15 | 4    |     20.89 | 1.21 | [18.52, 23.26] |      1.91
3.44 | 4    |     19.39 | 1.32 | [16.80, 21.97] |     -0.19
3.44 | 4    |     19.39 | 1.32 | [16.80, 21.97] |     -1.59
4.07 | 3    |     15.43 | 0.74 | [13.98, 16.88] |      0.97
3.73 | 3    |     17.19 | 0.72 | [15.79, 18.60] |      0.11
3.78 | 3    |     16.94 | 0.71 | [15.54, 18.34] |     -1.74
5.25 | 3    |      9.30 | 1.21 | [ 6.93, 11.67] |      1.10
5.42 | 3    |      8.40 | 1.30 | [ 5.84, 10.95] |      2.00
5.34 | 3    |      8.81 | 1.26 | [ 6.34, 11.28] |      5.89
2.20 | 4    |     25.83 | 1.05 | [23.77, 27.88] |      6.57
1.61 | 4    |     28.86 | 1.13 | [26.64, 31.08] |      1.54
1.83 | 4    |     27.72 | 1.09 | [25.59, 29.85] |      6.18
2.46 | 3    |     23.76 | 1.14 | [21.53, 26.00] |     -2.26
3.52 | 3    |     18.29 | 0.74 | [16.84, 19.73] |     -2.79
3.44 | 3    |     18.73 | 0.75 | [17.25, 20.20] |     -3.53
3.84 | 3    |     16.62 | 0.71 | [15.22, 18.02] |     -3.32
3.85 | 3    |     16.60 | 0.72 | [15.20, 18.00] |      2.60
1.94 | 4    |     27.20 | 1.07 | [25.10, 29.30] |      0.10
2.14 | 5    |     25.30 | 1.61 | [22.15, 28.45] |      0.70
1.51 | 5    |     28.56 | 1.92 | [24.78, 32.33] |      1.84
3.17 | 5    |     19.95 | 1.24 | [17.53, 22.37] |     -4.15
2.77 | 5    |     22.03 | 1.35 | [19.38, 24.68] |     -2.33
3.57 | 5    |     17.87 | 1.17 | [15.58, 20.17] |     -2.87
2.78 | 4    |     22.81 | 1.11 | [20.64, 24.98] |     -1.41
[33m
Variable predicted: mpg
[39m> estimate_relation(model)
[34mModel-based Predictions[39m

wt   | Predicted |   SE |             CI
----------------------------------------
1.51 |     28.89 | 1.35 | [26.23, 31.54]
1.95 |     26.63 | 1.11 | [24.45, 28.80]
2.38 |     24.37 | 0.89 | [22.63, 26.12]
2.82 |     22.11 | 0.73 | [20.69, 23.54]
3.25 |     19.86 | 0.66 | [18.57, 21.15]
3.69 |     17.60 | 0.71 | [16.21, 18.99]
4.12 |     15.35 | 0.86 | [13.66, 17.04]
4.55 |     13.09 | 1.07 | [10.98, 15.19]
4.99 |     10.83 | 1.32 | [ 8.26, 13.41]
5.42 |      8.57 | 1.57 | [ 5.49, 11.66]
[33m
Variable predicted: mpg
Predictors modulated: wt
[39m> estim <- estimate_relation(model, by = "gear")
> estim
[34mModel-based Predictions[39m

gear | Predicted |   SE |         95% CI
----------------------------------------
3    |     19.86 | 0.81 | [18.27, 21.45]
4    |     20.54 | 1.23 | [18.13, 22.96]
5    |     19.71 | 1.22 | [17.30, 22.11]
[33m
Variable predicted: mpg
Predictors modulated: gear
Predictors controlled: wt (3.2)
[39m> estimate_contrasts(estim)
[34mModel-based Contrasts Analysis[39m

Level1 | Level2 | Difference |   SE |        95% CI | Statistic |     p
-----------------------------------------------------------------------
3      | 4      |      -0.68 | 1.48 | [-3.58, 2.21] |     -0.46 | 0.643
3      | 5      |       0.15 | 1.47 | [-2.73, 3.03] |      0.10 | 0.917
4      | 5      |       0.84 | 1.74 | [-2.57, 4.24] |      0.48 | 0.630
[33m
Variable predicted: mpg
Predictors contrasted: gear
Predictors averaged: wt (3.2)
[39m> ## End(Don't show)
> 
> 
> 
> cleanEx()
> nameEx("estimate_grouplevel")
> ### * estimate_grouplevel
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: estimate_grouplevel
> ### Title: Group-specific parameters of mixed models random effects
> ### Aliases: estimate_grouplevel estimate_grouplevel.default
> ###   estimate_grouplevel.brmsfit reshape_grouplevel
> ###   reshape_grouplevel.estimate_grouplevel
> 
> ### ** Examples
> 
> ## Don't show: 
> if (all(insight::check_if_installed(c("see", "lme4"), quietly = TRUE)) && packageVersion("insight") > "1.1.0" && packageVersion("parameters") > "0.24.1") withAutoprint({ # examplesIf
+ ## End(Don't show)
+ # lme4 model
+ data(mtcars)
+ model <- lme4::lmer(mpg ~ hp + (1 | carb), data = mtcars)
+ random <- estimate_grouplevel(model)
+ 
+ # Show group-specific effects
+ random
+ 
+ # Visualize random effects
+ plot(random)
+ 
+ # Reshape to wide data...
+ reshaped <- reshape_grouplevel(random, group = "carb", indices = c("Coefficient", "SE"))
+ 
+ # ...and can be easily combined with the original data
+ alldata <- merge(mtcars, reshaped)
+ 
+ # overall coefficients
+ estimate_grouplevel(model, type = "total")
+ ## Don't show: 
+ }) # examplesIf
> data(mtcars)
> model <- lme4::lmer(mpg ~ hp + (1 | carb), data = mtcars)
> random <- estimate_grouplevel(model)
> random
Group | Level | Parameter   | Coefficient |   SE |        95% CI
----------------------------------------------------------------
carb  | 1     | (Intercept) |        0.41 | 0.84 | [-1.24, 2.05]
carb  | 2     | (Intercept) |        0.11 | 0.78 | [-1.42, 1.65]
carb  | 3     | (Intercept) |       -0.32 | 0.94 | [-2.16, 1.51]
carb  | 4     | (Intercept) |       -0.78 | 0.78 | [-2.31, 0.75]
carb  | 6     | (Intercept) |        0.09 | 1.00 | [-1.87, 2.05]
carb  | 8     | (Intercept) |        0.50 | 1.00 | [-1.47, 2.46]
> plot(random)
> reshaped <- reshape_grouplevel(random, group = "carb", indices = c("Coefficient", 
+     "SE"))
> alldata <- merge(mtcars, reshaped)
> estimate_grouplevel(model, type = "total")
Group | Level | Parameter   | Coefficient
-----------------------------------------
carb  | 1     | (Intercept) |       30.18
carb  | 2     | (Intercept) |       29.88
carb  | 3     | (Intercept) |       29.45
carb  | 4     | (Intercept) |       28.99
carb  | 6     | (Intercept) |       29.87
carb  | 8     | (Intercept) |       30.27
> ## End(Don't show)
> 
> 
> 
> cleanEx()
> nameEx("estimate_means")
> ### * estimate_means
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: estimate_means
> ### Title: Estimate Marginal Means (Model-based average at each factor
> ###   level)
> ### Aliases: estimate_means
> 
> ### ** Examples
> 
> ## Don't show: 
> if (all(insight::check_if_installed(c("marginaleffects", "see", "lme4"), quietly = TRUE))) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ library(modelbased)
+ 
+ # Frequentist models
+ # -------------------
+ model <- lm(Petal.Length ~ Sepal.Width * Species, data = iris)
+ 
+ estimate_means(model)
+ 
+ # the `length` argument is passed to `insight::get_datagrid()` and modulates
+ # the number of representative values to return for numeric predictors
+ estimate_means(model, by = c("Species", "Sepal.Width"), length = 2)
+ 
+ # an alternative way to setup your data grid is specify the values directly
+ estimate_means(model, by = c("Species", "Sepal.Width = c(2, 4)"))
+ 
+ # or use one of the many predefined "tokens" that help you creating a useful
+ # data grid - to learn more about creating data grids, see help in
+ # `?insight::get_datagrid`.
+ estimate_means(model, by = c("Species", "Sepal.Width = [fivenum]"))
+ 
+ ## Not run: 
+ ##D # same for factors: filter by specific levels
+ ##D estimate_means(model, by = "Species = c('versicolor', 'setosa')")
+ ##D estimate_means(model, by = c("Species", "Sepal.Width = 0"))
+ ##D 
+ ##D # estimate marginal average of response at values for numeric predictor
+ ##D estimate_means(model, by = "Sepal.Width", length = 5)
+ ##D estimate_means(model, by = "Sepal.Width = c(2, 4)")
+ ##D 
+ ##D # or provide the definition of the data grid as list
+ ##D estimate_means(
+ ##D   model,
+ ##D   by = list(Sepal.Width = c(2, 4), Species = c("versicolor", "setosa"))
+ ##D )
+ ##D 
+ ##D # equivalence test: the null-hypothesis is that the estimate is outside
+ ##D # the equivalence bounds [-4.5, 4.5]
+ ##D estimate_means(model, by = "Species", equivalence = c(-4.5, 4.5))
+ ##D 
+ ##D # Methods that can be applied to it:
+ ##D means <- estimate_means(model, by = c("Species", "Sepal.Width = 0"))
+ ##D 
+ ##D plot(means) # which runs visualisation_recipe()
+ ##D standardize(means)
+ ##D 
+ ##D # grids for numeric predictors, combine range and length
+ ##D model <- lm(Sepal.Length ~ Sepal.Width * Petal.Length, data = iris)
+ ##D 
+ ##D # create a "grid": value range for first numeric predictor, mean +/-1 SD
+ ##D # for remaining numeric predictors.
+ ##D estimate_means(model, c("Sepal.Width", "Petal.Length"), range = "grid")
+ ##D 
+ ##D # range from minimum to maximum spread over four values,
+ ##D # and mean +/- 1 SD (a total of three values)
+ ##D estimate_means(
+ ##D   model,
+ ##D   by = c("Sepal.Width", "Petal.Length"),
+ ##D   range = c("range", "sd"),
+ ##D   length = c(4, 3)
+ ##D )
+ ##D 
+ ##D data <- iris
+ ##D data$Petal.Length_factor <- ifelse(data$Petal.Length < 4.2, "A", "B")
+ ##D 
+ ##D model <- lme4::lmer(
+ ##D   Petal.Length ~ Sepal.Width + Species + (1 | Petal.Length_factor),
+ ##D   data = data
+ ##D )
+ ##D estimate_means(model)
+ ##D estimate_means(model, by = "Sepal.Width", length = 3)
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
> library(modelbased)
> model <- lm(Petal.Length ~ Sepal.Width * Species, data = iris)
> estimate_means(model)
We selected `by=c("Species")`.
[34mEstimated Marginal Means[39m

Species    | Mean |   SE |       95% CI | t(144)
------------------------------------------------
setosa     | 1.43 | 0.08 | [1.28, 1.58] |  18.70
versicolor | 4.50 | 0.07 | [4.35, 4.65] |  60.64
virginica  | 5.61 | 0.06 | [5.50, 5.72] |  99.61
[33m
Variable predicted: Petal.Length
Predictors modulated: Species
Predictors averaged: Sepal.Width (3.1)
[39m> estimate_means(model, by = c("Species", "Sepal.Width"), length = 2)
[34mEstimated Marginal Means[39m

Species    | Sepal.Width | Mean |   SE |       95% CI | t(144)
--------------------------------------------------------------
setosa     |        2.00 | 1.35 | 0.21 | [0.92, 1.77] |   6.28
versicolor |        2.00 | 3.61 | 0.15 | [3.33, 3.90] |  24.81
virginica  |        2.00 | 4.88 | 0.17 | [4.54, 5.23] |  27.92
setosa     |        4.40 | 1.54 | 0.15 | [1.24, 1.84] |  10.19
versicolor |        4.40 | 5.63 | 0.29 | [5.05, 6.20] |  19.34
virginica  |        4.40 | 6.53 | 0.25 | [6.04, 7.02] |  26.19
[33m
Variable predicted: Petal.Length
Predictors modulated: Species, Sepal.Width
[39m> estimate_means(model, by = c("Species", "Sepal.Width = c(2, 4)"))
[34mEstimated Marginal Means[39m

Species    | Sepal.Width | Mean |   SE |       95% CI | t(144)
--------------------------------------------------------------
setosa     |           2 | 1.35 | 0.21 | [0.92, 1.77] |   6.28
versicolor |           2 | 3.61 | 0.15 | [3.33, 3.90] |  24.81
virginica  |           2 | 4.88 | 0.17 | [4.54, 5.23] |  27.92
setosa     |           4 | 1.51 | 0.10 | [1.31, 1.70] |  15.19
versicolor |           4 | 5.29 | 0.22 | [4.85, 5.73] |  23.78
virginica  |           4 | 6.26 | 0.18 | [5.89, 6.62] |  34.11
[33m
Variable predicted: Petal.Length
Predictors modulated: Species, Sepal.Width = c(2, 4)
[39m> estimate_means(model, by = c("Species", "Sepal.Width = [fivenum]"))
[34mEstimated Marginal Means[39m

Species    | Sepal.Width | Mean |   SE |       95% CI | t(144)
--------------------------------------------------------------
setosa     |        2.00 | 1.35 | 0.21 | [0.92, 1.77] |   6.28
versicolor |        2.00 | 3.61 | 0.15 | [3.33, 3.90] |  24.81
virginica  |        2.00 | 4.88 | 0.17 | [4.54, 5.23] |  27.92
setosa     |        2.80 | 1.41 | 0.11 | [1.20, 1.62] |  13.28
versicolor |        2.80 | 4.29 | 0.05 | [4.18, 4.39] |  78.28
virginica  |        2.80 | 5.43 | 0.06 | [5.31, 5.56] |  87.55
setosa     |        3.00 | 1.43 | 0.08 | [1.26, 1.59] |  17.27
versicolor |        3.00 | 4.45 | 0.07 | [4.32, 4.59] |  65.68
virginica  |        3.00 | 5.57 | 0.05 | [5.46, 5.68] | 101.89
setosa     |        3.30 | 1.45 | 0.06 | [1.34, 1.57] |  25.21
versicolor |        3.30 | 4.70 | 0.11 | [4.49, 4.92] |  43.66
virginica  |        3.30 | 5.78 | 0.08 | [5.62, 5.93] |  74.17
setosa     |        4.40 | 1.54 | 0.15 | [1.24, 1.84] |  10.19
versicolor |        4.40 | 5.63 | 0.29 | [5.05, 6.20] |  19.34
virginica  |        4.40 | 6.53 | 0.25 | [6.04, 7.02] |  26.19
[33m
Variable predicted: Petal.Length
Predictors modulated: Species, Sepal.Width = [fivenum]
[39m> ## End(Don't show)
> 
> 
> 
> cleanEx()
> nameEx("estimate_slopes")
> ### * estimate_slopes
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: estimate_slopes
> ### Title: Estimate Marginal Effects
> ### Aliases: estimate_slopes
> 
> ### ** Examples
> 
> ## Don't show: 
> if (all(insight::check_if_installed(c("marginaleffects", "emmeans", "effectsize", "mgcv", "ggplot2", "see"), quietly = TRUE))) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ library(ggplot2)
+ # Get an idea of the data
+ ggplot(iris, aes(x = Petal.Length, y = Sepal.Width)) +
+   geom_point(aes(color = Species)) +
+   geom_smooth(color = "black", se = FALSE) +
+   geom_smooth(aes(color = Species), linetype = "dotted", se = FALSE) +
+   geom_smooth(aes(color = Species), method = "lm", se = FALSE)
+ 
+ # Model it
+ model <- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
+ # Compute the marginal effect of Petal.Length at each level of Species
+ slopes <- estimate_slopes(model, trend = "Petal.Length", by = "Species")
+ slopes
+ 
+ # What is the *average* slope of Petal.Length? This can be calculated by
+ # taking the average of the slopes across all Species, using `comparison`.
+ # We pass a function to `comparison` that calculates the mean of the slopes.
+ estimate_slopes(
+   model,
+   trend = "Petal.Length",
+   by = "Species",
+   comparison = ~I(mean(x))
+ )
+ 
+ ## Not run: 
+ ##D # Plot it
+ ##D plot(slopes)
+ ##D standardize(slopes)
+ ##D 
+ ##D model <- mgcv::gam(Sepal.Width ~ s(Petal.Length), data = iris)
+ ##D slopes <- estimate_slopes(model, by = "Petal.Length", length = 50)
+ ##D summary(slopes)
+ ##D plot(slopes)
+ ##D 
+ ##D model <- mgcv::gam(Sepal.Width ~ s(Petal.Length, by = Species), data = iris)
+ ##D slopes <- estimate_slopes(model,
+ ##D   trend = "Petal.Length",
+ ##D   by = c("Petal.Length", "Species"), length = 20
+ ##D )
+ ##D summary(slopes)
+ ##D plot(slopes)
+ ##D 
+ ##D # marginal effects, grouped by Species, at different values of Petal.Length
+ ##D estimate_slopes(model,
+ ##D   trend = "Petal.Length",
+ ##D   by = c("Petal.Length", "Species"), length = 10
+ ##D )
+ ##D 
+ ##D # marginal effects at different values of Petal.Length
+ ##D estimate_slopes(model, trend = "Petal.Length", by = "Petal.Length", length = 10)
+ ##D 
+ ##D # marginal effects at very specific values of Petal.Length
+ ##D estimate_slopes(model, trend = "Petal.Length", by = "Petal.Length=c(1, 3, 5)")
+ ##D 
+ ##D # average marginal effects of Petal.Length,
+ ##D # just for the trend within a certain range
+ ##D estimate_slopes(model, trend = "Petal.Length=seq(2, 4, 0.01)")
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
> library(ggplot2)
> ggplot(iris, aes(x = Petal.Length, y = Sepal.Width)) + geom_point(aes(color = Species)) + 
+     geom_smooth(color = "black", se = FALSE) + geom_smooth(aes(color = Species), 
+     linetype = "dotted", se = FALSE) + geom_smooth(aes(color = Species), method = "lm", 
+     se = FALSE)
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
> model <- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
> slopes <- estimate_slopes(model, trend = "Petal.Length", by = "Species")
> slopes
[34mEstimated Marginal Effects[39m

Species    | Slope |   SE |        95% CI | t(144) |      p
-----------------------------------------------------------
setosa     |  0.39 | 0.26 | [-0.13, 0.90] |   1.49 |  0.138
versicolor |  0.37 | 0.10 | [ 0.18, 0.56] |   3.89 | < .001
virginica  |  0.23 | 0.08 | [ 0.07, 0.40] |   2.86 |  0.005
[33m
Marginal effects estimated for Petal.Length
Type of slope was dY/dX[39m> estimate_slopes(model, trend = "Petal.Length", by = "Species", comparison = ~I(mean(x)))
[34mEstimated Marginal Effects[39m

Slope |   SE |       95% CI | t(144) |      p
---------------------------------------------
0.33  | 0.10 | [0.14, 0.52] |   3.45 | < .001
[33m
Marginal effects estimated for Petal.Length[39m> ## End(Don't show)
> ## Don't show: 
> if (all(insight::check_if_installed(c("marginaleffects", "emmeans"), quietly = TRUE)) && getRversion() >= "4.5.0") withAutoprint({ # examplesIf
+ ## End(Don't show)
+ ## Not run: 
+ ##D # marginal effects with different `estimate` options
+ ##D data(penguins)
+ ##D penguins$long_bill <- factor(datawizard::categorize(penguins$bill_len), labels = c("short", "long"))
+ ##D m <- glm(long_bill ~ sex + species + island * bill_dep, data = penguins, family = "binomial")
+ ##D 
+ ##D # the emmeans default
+ ##D estimate_slopes(m, "bill_dep", by = "island")
+ ##D emmeans::emtrends(m, "island", var = "bill_dep", regrid = "response")
+ ##D 
+ ##D # the marginaleffects default
+ ##D estimate_slopes(m, "bill_dep", by = "island", estimate = "average")
+ ##D marginaleffects::avg_slopes(m, variables = "bill_dep", by = "island")
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
> ## End(Don't show)
> 
> 
> 
> cleanEx()

detaching â€˜package:ggplot2â€™

> nameEx("get_emmeans")
> ### * get_emmeans
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: get_emcontrasts
> ### Title: Consistent API for 'emmeans' and 'marginaleffects'
> ### Aliases: get_emcontrasts get_emmeans get_emtrends get_marginalcontrasts
> ###   get_marginalmeans get_marginaltrends
> 
> ### ** Examples
> 
> ## Don't show: 
> if (insight::check_if_installed("emmeans", quietly = TRUE)) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ # Basic usage
+ model <- lm(Sepal.Width ~ Species, data = iris)
+ get_emcontrasts(model)
+ 
+ ## Not run: 
+ ##D # Dealing with interactions
+ ##D model <- lm(Sepal.Width ~ Species * Petal.Width, data = iris)
+ ##D # By default: selects first factor
+ ##D get_emcontrasts(model)
+ ##D # Or both
+ ##D get_emcontrasts(model, contrast = c("Species", "Petal.Width"), length = 2)
+ ##D # Or with custom specifications
+ ##D get_emcontrasts(model, contrast = c("Species", "Petal.Width=c(1, 2)"))
+ ##D # Or modulate it
+ ##D get_emcontrasts(model, by = "Petal.Width", length = 4)
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
> model <- lm(Sepal.Width ~ Species, data = iris)
> get_emcontrasts(model)
No variable was specified for contrast estimation. Selecting `contrast =
  "Species"`.
 contrast               estimate     SE  df t.ratio p.value
 setosa - versicolor       0.658 0.0679 147   9.685 <0.0001
 setosa - virginica        0.454 0.0679 147   6.683 <0.0001
 versicolor - virginica   -0.204 0.0679 147  -3.003  0.0088

P value adjustment: tukey method for comparing a family of 3 estimates 
> ## End(Don't show)
> ## Don't show: 
> if (require("emmeans", quietly = TRUE)) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ model <- lm(Sepal.Length ~ Species + Petal.Width, data = iris)
+ 
+ # By default, 'by' is set to "Species"
+ get_emmeans(model)
+ 
+ ## Not run: 
+ ##D # Overall mean (close to 'mean(iris$Sepal.Length)')
+ ##D get_emmeans(model, by = NULL)
+ ##D 
+ ##D # One can estimate marginal means at several values of a 'modulate' variable
+ ##D get_emmeans(model, by = "Petal.Width", length = 3)
+ ##D 
+ ##D # Interactions
+ ##D model <- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
+ ##D 
+ ##D get_emmeans(model)
+ ##D get_emmeans(model, by = c("Species", "Petal.Length"), length = 2)
+ ##D get_emmeans(model, by = c("Species", "Petal.Length = c(1, 3, 5)"), length = 2)
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
Welcome to emmeans.
Caution: You lose important information if you filter this package's results.
See '? untidy'
> model <- lm(Sepal.Length ~ Species + Petal.Width, data = iris)
> get_emmeans(model)
We selected `by = c("Species")`.
 Species    emmean     SE  df lower.CL upper.CL
 setosa       5.88 0.1970 146     5.49     6.27
 versicolor   5.82 0.0723 146     5.68     5.96
 virginica    5.83 0.1740 146     5.49     6.17

Confidence level used: 0.95 
> ## End(Don't show)
> ## Don't show: 
> if (insight::check_if_installed("emmeans", quietly = TRUE)) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ ## Not run: 
+ ##D model <- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
+ ##D 
+ ##D get_emtrends(model)
+ ##D get_emtrends(model, by = "Species")
+ ##D get_emtrends(model, by = "Petal.Length")
+ ##D get_emtrends(model, by = c("Species", "Petal.Length"))
+ ## End(Not run)
+ 
+ model <- lm(Petal.Length ~ poly(Sepal.Width, 4), data = iris)
+ get_emtrends(model)
+ get_emtrends(model, by = "Sepal.Width")
+ ## Don't show: 
+ }) # examplesIf
> model <- lm(Petal.Length ~ poly(Sepal.Width, 4), data = iris)
> get_emtrends(model)
No numeric variable was specified for slope estimation. Selecting `trend
  = "Sepal.Width"`.
 1       Sepal.Width.trend    SE  df lower.CL upper.CL
 overall             -2.67 0.548 145    -3.75    -1.58

Confidence level used: 0.95 
> get_emtrends(model, by = "Sepal.Width")
No numeric variable was specified for slope estimation. Selecting `trend
  = "Sepal.Width"`.
 Sepal.Width Sepal.Width.trend    SE  df lower.CL upper.CL
        2.00             7.484 5.420 145   -3.225   18.192
        2.27             3.775 2.090 145   -0.357    7.906
        2.53             0.834 0.765 145   -0.678    2.346
        2.80            -1.337 0.706 145   -2.732    0.058
        3.07            -2.700 0.543 145   -3.773   -1.628
        3.33            -3.231 0.606 145   -4.430   -2.033
        3.60            -2.909 0.838 145   -4.564   -1.254
        3.87            -1.705 1.010 145   -3.701    0.290
        4.13             0.394 2.390 145   -4.327    5.116
        4.40             3.431 5.800 145   -8.028   14.890

Confidence level used: 0.95 
> ## End(Don't show)
> ## Don't show: 
> if (insight::check_if_installed("marginaleffects", quietly = TRUE)) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ model <- lm(Sepal.Length ~ Species + Petal.Width, data = iris)
+ 
+ # By default, 'by' is set to "Species"
+ get_marginalmeans(model)
+ 
+ # Overall mean (close to 'mean(iris$Sepal.Length)')
+ get_marginalmeans(model, by = NULL)
+ 
+ ## Not run: 
+ ##D # One can estimate marginal means at several values of a 'modulate' variable
+ ##D get_marginalmeans(model, by = "Petal.Width", length = 3)
+ ##D 
+ ##D # Interactions
+ ##D model <- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
+ ##D 
+ ##D get_marginalmeans(model)
+ ##D get_marginalmeans(model, by = c("Species", "Petal.Length"), length = 2)
+ ##D get_marginalmeans(model, by = c("Species", "Petal.Length = c(1, 3, 5)"), length = 2)
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
> model <- lm(Sepal.Length ~ Species + Petal.Width, data = iris)
> get_marginalmeans(model)
We selected `by=c("Species")`.

    Species Estimate Std. Error    t Pr(>|t|)     S 2.5 % 97.5 %  Df
 setosa         5.88     0.1969 29.9   <0.001 210.3  5.49   6.27 146
 versicolor     5.82     0.0723 80.5   <0.001 405.6  5.68   5.96 146
 virginica      5.83     0.1741 33.5   <0.001 231.4  5.49   6.17 146

Type: response

> get_marginalmeans(model, by = NULL)

 Estimate Std. Error   t Pr(>|t|)     S 2.5 % 97.5 %  Df
     5.84     0.0393 149   <0.001 533.4  5.77   5.92 146

Type: response

> ## End(Don't show)
> ## Don't show: 
> if (insight::check_if_installed("marginaleffects", quietly = TRUE)) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ model <- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
+ 
+ get_marginaltrends(model, trend = "Petal.Length", by = "Species")
+ get_marginaltrends(model, trend = "Petal.Length", by = "Petal.Length")
+ get_marginaltrends(model, trend = "Petal.Length", by = c("Species", "Petal.Length"))
+ ## Don't show: 
+ }) # examplesIf
> model <- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
> get_marginaltrends(model, trend = "Petal.Length", by = "Species")

    Species Estimate Std. Error    t Pr(>|t|)    S   2.5 % 97.5 %  Df
 setosa        0.388     0.2601 1.49  0.13815  2.9 -0.1263  0.902 144
 versicolor    0.374     0.0963 3.89  < 0.001 12.7  0.1839  0.565 144
 virginica     0.234     0.0819 2.86  0.00485  7.7  0.0724  0.396 144

Term: Petal.Length
Type: response
Comparison: dY/dX

> get_marginaltrends(model, trend = "Petal.Length", by = "Petal.Length")

 Petal.Length Estimate Std. Error    t Pr(>|t|)    S 2.5 % 97.5 %  Df
         1.00    0.332     0.0963 3.45   <0.001 10.4 0.142  0.523 144
         1.66    0.332     0.0964 3.45   <0.001 10.4 0.142  0.523 144
         2.31    0.332     0.0965 3.44   <0.001 10.4 0.141  0.523 144
         2.97    0.332     0.0963 3.45   <0.001 10.4 0.142  0.522 144
         3.62    0.332     0.0966 3.44   <0.001 10.4 0.141  0.523 144
         4.28    0.332     0.0963 3.45   <0.001 10.4 0.142  0.523 144
         4.93    0.332     0.0963 3.45   <0.001 10.4 0.142  0.523 144
         5.59    0.332     0.0963 3.45   <0.001 10.4 0.142  0.522 144
         6.24    0.332     0.0963 3.45   <0.001 10.4 0.142  0.523 144
         6.90    0.332     0.0963 3.45   <0.001 10.4 0.142  0.522 144

Term: Petal.Length
Type: response
Comparison: dY/dX

> get_marginaltrends(model, trend = "Petal.Length", by = c("Species", "Petal.Length"))

    Species Petal.Length Estimate Std. Error    t Pr(>|t|)    S   2.5 % 97.5 %
 setosa             1.00    0.388     0.2602 1.49  0.13820  2.9 -0.1264  0.902
 setosa             1.66    0.388     0.2601 1.49  0.13815  2.9 -0.1263  0.902
 versicolor         3.62    0.374     0.0959 3.90  < 0.001 12.7  0.1847  0.564
 versicolor         4.28    0.374     0.0963 3.89  < 0.001 12.7  0.1840  0.565
 versicolor         4.93    0.374     0.0963 3.89  < 0.001 12.7  0.1840  0.565
 virginica          4.93    0.234     0.0819 2.86  0.00482  7.7  0.0726  0.396
 virginica          5.59    0.234     0.0819 2.86  0.00483  7.7  0.0725  0.396
 virginica          6.24    0.234     0.0819 2.86  0.00486  7.7  0.0724  0.396
 virginica          6.90    0.234     0.0819 2.86  0.00484  7.7  0.0725  0.396
  Df
 144
 144
 144
 144
 144
 144
 144
 144
 144

Term: Petal.Length
Type: response
Comparison: dY/dX

> ## End(Don't show)
> 
> 
> 
> cleanEx()

detaching â€˜package:emmeansâ€™

> nameEx("pool_contrasts")
> ### * pool_contrasts
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: pool_contrasts
> ### Title: Pool contrasts and comparisons from 'estimate_contrasts()'
> ### Aliases: pool_contrasts
> 
> ### ** Examples
> 
> ## Don't show: 
> if (require("mice")) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ data("nhanes2", package = "mice")
+ imp <- mice::mice(nhanes2, printFlag = FALSE)
+ comparisons <- lapply(1:5, function(i) {
+   m <- lm(bmi ~ age + hyp + chl, data = mice::complete(imp, action = i))
+   estimate_contrasts(m, "age")
+ })
+ pool_contrasts(comparisons)
+ ## Don't show: 
+ }) # examplesIf
Loading required package: mice

Attaching package: â€˜miceâ€™

The following object is masked from â€˜package:statsâ€™:

    filter

The following objects are masked from â€˜package:baseâ€™:

    cbind, rbind

> data("nhanes2", package = "mice")
> imp <- mice::mice(nhanes2, printFlag = FALSE)
> comparisons <- lapply(1:5, function(i) {
+     m <- lm(bmi ~ age + hyp + chl, data = mice::complete(imp, action = i))
+     estimate_contrasts(m, "age")
+ })
> pool_contrasts(comparisons)
[34mMarginal Contrasts Analysis[39m

Level1 | Level2 | Difference |   SE |         95% CI |  t(3) |     p
--------------------------------------------------------------------
40-59  | 20-39  |      -4.67 | 2.57 | [-12.85, 3.52] | -1.81 | 0.167
60-99  | 20-39  |      -6.55 | 2.92 | [-15.84, 2.74] | -2.24 | 0.111
60-99  | 40-59  |      -1.88 | 2.03 | [ -8.35, 4.58] | -0.93 | 0.422
[33m
Variable predicted: bmi
Predictors contrasted: age
Predictors averaged: hyp, chl (1.9e+02)
p-values are uncorrected.
[39m> ## End(Don't show)
> 
> 
> 
> cleanEx()

detaching â€˜package:miceâ€™

> nameEx("pool_predictions")
> ### * pool_predictions
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: pool_predictions
> ### Title: Pool Predictions and Estimated Marginal Means
> ### Aliases: pool_predictions pool_slopes
> 
> ### ** Examples
> 
> ## Don't show: 
> if (require("mice") && requireNamespace("marginaleffects")) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ # example for multiple imputed datasets
+ data("nhanes2", package = "mice")
+ imp <- mice::mice(nhanes2, printFlag = FALSE)
+ 
+ # estimated marginal means
+ predictions <- lapply(1:5, function(i) {
+   m <- lm(bmi ~ age + hyp + chl, data = mice::complete(imp, action = i))
+   estimate_means(m, "age")
+ })
+ pool_predictions(predictions)
+ 
+ # estimated slopes (marginal effects)
+ slopes <- lapply(1:5, function(i) {
+   m <- lm(bmi ~ age + hyp + chl, data = mice::complete(imp, action = i))
+   estimate_slopes(m, "chl")
+ })
+ pool_slopes(slopes)
+ ## Don't show: 
+ }) # examplesIf
Loading required package: mice

Attaching package: â€˜miceâ€™

The following object is masked from â€˜package:statsâ€™:

    filter

The following objects are masked from â€˜package:baseâ€™:

    cbind, rbind

> data("nhanes2", package = "mice")
> imp <- mice::mice(nhanes2, printFlag = FALSE)
> predictions <- lapply(1:5, function(i) {
+     m <- lm(bmi ~ age + hyp + chl, data = mice::complete(imp, action = i))
+     estimate_means(m, "age")
+ })
> pool_predictions(predictions)
[34mEstimated Marginal Means[39m

age   |  Mean |   SE |        95% CI |  t(1)
--------------------------------------------
20-39 | 30.00 | 1.71 | [8.23, 51.77] | 17.51
40-59 | 25.33 | 1.60 | [5.03, 45.64] | 15.86
60-99 | 23.45 | 1.73 | [1.43, 45.47] | 13.53
[33m
Variable predicted: bmi
Predictors modulated: age
Predictors averaged: hyp, chl (1.9e+02)
[39m> slopes <- lapply(1:5, function(i) {
+     m <- lm(bmi ~ age + hyp + chl, data = mice::complete(imp, action = i))
+     estimate_slopes(m, "chl")
+ })
> pool_slopes(slopes)
[34mEstimated Marginal Effects[39m

Slope |   SE |       95% CI | t(20) |     p
-------------------------------------------
0.05  | 0.02 | [0.00, 0.10] |  2.25 | 0.036
[33m
Marginal effects estimated for chl
Type of slope was dY/dX[39m> ## End(Don't show)
> 
> 
> 
> cleanEx()

detaching â€˜package:miceâ€™

> nameEx("print.estimate_contrasts")
> ### * print.estimate_contrasts
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: display.estimate_contrasts
> ### Title: Printing modelbased-objects
> ### Aliases: display.estimate_contrasts format.estimate_contrasts
> ###   print.estimate_contrasts
> 
> ### ** Examples
> 
> ## Don't show: 
> if (insight::check_if_installed("marginaleffects", quietly = TRUE)) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ model <- lm(Petal.Length ~ Species, data = iris)
+ out <- estimate_means(model, "Species")
+ 
+ # default
+ print(out)
+ 
+ # smaller set of columns
+ print(out, select = "minimal")
+ 
+ # remove redundant labels
+ data(efc, package = "modelbased")
+ efc <- datawizard::to_factor(efc, c("c161sex", "c172code", "e16sex"))
+ levels(efc$c172code) <- c("low", "mid", "high")
+ fit <- lm(neg_c_7 ~ c161sex * c172code * e16sex, data = efc)
+ out <- estimate_means(fit, c("c161sex", "c172code", "e16sex"))
+ print(out, full_labels = FALSE, select = "{estimate} ({se})")
+ ## Don't show: 
+ }) # examplesIf
> model <- lm(Petal.Length ~ Species, data = iris)
> out <- estimate_means(model, "Species")
> print(out)
[34mEstimated Marginal Means[39m

Species    | Mean |   SE |       95% CI | t(147)
------------------------------------------------
setosa     | 1.46 | 0.06 | [1.34, 1.58] |  24.02
versicolor | 4.26 | 0.06 | [4.14, 4.38] |  70.00
virginica  | 5.55 | 0.06 | [5.43, 5.67] |  91.23
[33m
Variable predicted: Petal.Length
Predictors modulated: Species
[39m> print(out, select = "minimal")
[34mEstimated Marginal Means[39m

Species    |         Mean (CI)
------------------------------
setosa     | 1.46 (1.34, 1.58)
versicolor | 4.26 (4.14, 4.38)
virginica  | 5.55 (5.43, 5.67)
[33m
Variable predicted: Petal.Length
Predictors modulated: Species
[39m> data(efc, package = "modelbased")
> efc <- datawizard::to_factor(efc, c("c161sex", "c172code", "e16sex"))
> levels(efc$c172code) <- c("low", "mid", "high")
> fit <- lm(neg_c_7 ~ c161sex * c172code * e16sex, data = efc)
> out <- estimate_means(fit, c("c161sex", "c172code", "e16sex"))
> print(out, full_labels = FALSE, select = "{estimate} ({se})")
[34mEstimated Marginal Means[39m

c161sex | c172code | e16sex |    Mean (SE)
------------------------------------------
Male    | low      | male   |  9.47 (1.00)
Female  |          |        | 12.13 (0.48)
Male    | mid      |        | 12.16 (0.68)
Female  |          |        | 12.48 (0.35)
Male    | high     |        | 12.31 (1.07)
Female  |          |        | 12.37 (0.71)
Male    | low      | female | 11.92 (0.76)
Female  |          |        | 12.11 (0.46)
Male    | mid      |        | 10.93 (0.43)
Female  |          |        | 11.57 (0.24)
Male    | high     |        | 11.42 (0.67)
Female  |          |        | 12.74 (0.44)
[33m
Variable predicted: neg_c_7
Predictors modulated: c161sex, c172code, e16sex
[39m> ## End(Don't show)
> 
> 
> 
> cleanEx()
> nameEx("residualize_over_grid")
> ### * residualize_over_grid
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: residualize_over_grid
> ### Title: Compute partial residuals from a data grid
> ### Aliases: residualize_over_grid residualize_over_grid.data.frame
> 
> ### ** Examples
> 
> ## Don't show: 
> if (requireNamespace("marginaleffects", quietly = TRUE)) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ set.seed(1234)
+ x1 <- rnorm(200)
+ x2 <- rnorm(200)
+ # quadratic relationship
+ y <- 2 * x1 + x1^2 + 4 * x2 + rnorm(200)
+ 
+ d <- data.frame(x1, x2, y)
+ model <- lm(y ~ x1 + x2, data = d)
+ 
+ pr <- estimate_means(model, c("x1", "x2"))
+ head(residualize_over_grid(pr, model))
+ ## Don't show: 
+ }) # examplesIf
> set.seed(1234)
> x1 <- rnorm(200)
> x2 <- rnorm(200)
> y <- 2 * x1 + x1^2 + 4 * x2 + rnorm(200)
> d <- data.frame(x1, x2, y)
> model <- lm(y ~ x1 + x2, data = d)
> pr <- estimate_means(model, c("x1", "x2"))
> head(residualize_over_grid(pr, model))
         x1    x2     Mean
37   -0.889 0.814 1.668084
57    0.422 0.814 4.203154
66    1.077 0.112 3.374450
17   -2.200 0.814 3.450142
56    0.422 0.112 1.943842
57.1  0.422 0.814 4.484100
> ## End(Don't show)
> 
> 
> 
> cleanEx()
> nameEx("smoothing")
> ### * smoothing
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: smoothing
> ### Title: Smoothing a vector or a time series
> ### Aliases: smoothing
> 
> ### ** Examples
> 
> x <- sin(seq(0, 4 * pi, length.out = 100)) + rnorm(100, 0, 0.2)
> plot(x, type = "l")
> lines(smoothing(x, method = "smooth"), type = "l", col = "blue")
> lines(smoothing(x, method = "loess"), type = "l", col = "red")
> 
> x <- sin(seq(0, 4 * pi, length.out = 10000)) + rnorm(10000, 0, 0.2)
> plot(x, type = "l")
> lines(smoothing(x, method = "smooth"), type = "l", col = "blue")
> lines(smoothing(x, method = "loess"), type = "l", col = "red")
> 
> 
> 
> cleanEx()
> nameEx("visualisation_recipe.estimate_predicted")
> ### * visualisation_recipe.estimate_predicted
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plot.estimate_predicted
> ### Title: Automated plotting for 'modelbased' objects
> ### Aliases: plot.estimate_predicted plot.estimate_means
> ###   tinyplot.estimate_means visualisation_recipe.estimate_predicted
> ###   visualisation_recipe.estimate_slopes
> ###   visualisation_recipe.estimate_grouplevel
> 
> ### ** Examples
> 
> ## Don't show: 
> if (all(insight::check_if_installed(c("tinyplot", "marginaleffects"), quietly = TRUE))) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ # ==============================================
+ # tinyplot
+ # ==============================================
+ ## Don't show: 
+ }) # examplesIf
> ## End(Don't show)
> ## Don't show: 
> if (all(insight::check_if_installed(c("marginaleffects", "see", "ggplot2"), quietly = TRUE)) && getRversion() >= "4.1.0") withAutoprint({ # examplesIf
+ ## End(Don't show)
+ library(ggplot2)
+ library(see)
+ # ==============================================
+ # estimate_relation, estimate_expectation, ...
+ # ==============================================
+ # Simple Model ---------------
+ x <- estimate_relation(lm(mpg ~ wt, data = mtcars))
+ layers <- visualisation_recipe(x)
+ layers
+ plot(layers)
+ 
+ # visualization_recipe() is called implicitly when you call plot()
+ plot(estimate_relation(lm(mpg ~ qsec, data = mtcars)))
+ 
+ ## Not run: 
+ ##D # It can be used in a pipe workflow
+ ##D lm(mpg ~ qsec, data = mtcars) |>
+ ##D   estimate_relation(ci = c(0.5, 0.8, 0.9)) |>
+ ##D   plot()
+ ##D 
+ ##D # Customize aesthetics ----------
+ ##D 
+ ##D plot(x,
+ ##D   point = list(color = "red", alpha = 0.6, size = 3),
+ ##D   line = list(color = "blue", size = 3),
+ ##D   ribbon = list(fill = "green", alpha = 0.7)
+ ##D ) +
+ ##D   theme_minimal() +
+ ##D   labs(title = "Relationship between MPG and WT")
+ ##D 
+ ##D # Customize raw data -------------
+ ##D 
+ ##D plot(x, point = list(geom = "density_2d_filled"), line = list(color = "white")) +
+ ##D   scale_x_continuous(expand = c(0, 0)) +
+ ##D   scale_y_continuous(expand = c(0, 0)) +
+ ##D   theme(legend.position = "none")
+ ##D 
+ ##D # Single predictors examples -----------
+ ##D 
+ ##D plot(estimate_relation(lm(Sepal.Length ~ Species, data = iris)))
+ ##D 
+ ##D # 2-ways interaction ------------
+ ##D 
+ ##D # Numeric * numeric
+ ##D x <- estimate_relation(lm(mpg ~ wt * qsec, data = mtcars))
+ ##D plot(x)
+ ##D 
+ ##D # Numeric * factor
+ ##D x <- estimate_relation(lm(Sepal.Width ~ Sepal.Length * Species, data = iris))
+ ##D plot(x)
+ ##D 
+ ##D # ==============================================
+ ##D # estimate_means
+ ##D # ==============================================
+ ##D # Simple Model ---------------
+ ##D x <- estimate_means(lm(Sepal.Width ~ Species, data = iris), by = "Species")
+ ##D layers <- visualisation_recipe(x)
+ ##D layers
+ ##D plot(layers)
+ ##D 
+ ##D # Customize aesthetics
+ ##D layers <- visualisation_recipe(x,
+ ##D   point = list(width = 0.03, color = "red"),
+ ##D   pointrange = list(size = 2, linewidth = 2),
+ ##D   line = list(linetype = "dashed", color = "blue")
+ ##D )
+ ##D plot(layers)
+ ##D 
+ ##D # Two levels ---------------
+ ##D data <- mtcars
+ ##D data$cyl <- as.factor(data$cyl)
+ ##D 
+ ##D model <- lm(mpg ~ cyl * wt, data = data)
+ ##D 
+ ##D x <- estimate_means(model, by = c("cyl", "wt"))
+ ##D plot(x)
+ ##D 
+ ##D 
+ ##D # GLMs ---------------------
+ ##D data <- data.frame(vs = mtcars$vs, cyl = as.factor(mtcars$cyl))
+ ##D x <- estimate_means(glm(vs ~ cyl, data = data, family = "binomial"), by = c("cyl"))
+ ##D plot(x)
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
> library(ggplot2)
> library(see)
> x <- estimate_relation(lm(mpg ~ wt, data = mtcars))
> layers <- visualisation_recipe(x)
> layers
[34mLayer 1
--------
[39m[33mGeom type: ribbon
[39mdata = [10 x 6]
aes_string(
  y = 'Predicted'
  x = 'wt'
  ymin = 'CI_low'
  ymax = 'CI_high'
  group = '.group'
)
alpha = 0.25

[34mLayer 2
--------
[39m[33mGeom type: line
[39mdata = [10 x 6]
aes_string(
  y = 'Predicted'
  x = 'wt'
  group = '.group'
)

[34mLayer 3
--------
[39m[33mGeom type: labs
[39my = 'Predicted value of mpg'

> plot(layers)
> plot(estimate_relation(lm(mpg ~ qsec, data = mtcars)))
> ## End(Don't show)
> ## Don't show: 
> if (all(insight::check_if_installed(c("marginaleffects", "see", "ggplot2"), quietly = TRUE))) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ # ==============================================
+ # estimate_slopes
+ # ==============================================
+ model <- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
+ x <- estimate_slopes(model, trend = "Petal.Length", by = "Species")
+ 
+ layers <- visualisation_recipe(x)
+ layers
+ plot(layers)
+ 
+ ## Not run: 
+ ##D # Customize aesthetics and add horizontal line and theme
+ ##D layers <- visualisation_recipe(x, pointrange = list(size = 2, linewidth = 2))
+ ##D plot(layers) +
+ ##D   geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
+ ##D   theme_minimal() +
+ ##D   labs(y = "Effect of Petal.Length", title = "Marginal Effects")
+ ##D 
+ ##D model <- lm(Petal.Length ~ poly(Sepal.Width, 4), data = iris)
+ ##D x <- estimate_slopes(model, trend = "Sepal.Width", by = "Sepal.Width", length = 20)
+ ##D plot(visualisation_recipe(x))
+ ##D 
+ ##D model <- lm(Petal.Length ~ Species * poly(Sepal.Width, 3), data = iris)
+ ##D x <- estimate_slopes(model, trend = "Sepal.Width", by = c("Sepal.Width", "Species"))
+ ##D plot(visualisation_recipe(x))
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
> model <- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
> x <- estimate_slopes(model, trend = "Petal.Length", by = "Species")
> layers <- visualisation_recipe(x)
> layers
[34mLayer 1
--------
[39m[33mGeom type: hline
[39myintercept = 0
alpha = 0.5
linetype = 'dashed'

[34mLayer 2
--------
[39m[33mGeom type: line
[39mdata = [3 x 9]
aes_string(
  y = 'Slope'
  x = 'Species'
  group = '.group'
)

[34mLayer 3
--------
[39m[33mGeom type: pointrange
[39mdata = [3 x 9]
aes_string(
  y = 'Slope'
  x = 'Species'
  ymin = 'CI_low'
  ymax = 'CI_high'
  group = '.group'
)

[34mLayer 4
--------
[39m[33mGeom type: labs
[39my = 'Slope of Petal.Length'

> plot(layers)
> ## End(Don't show)
> ## Don't show: 
> if (all(insight::check_if_installed(c("ggplot2", "marginaleffects", "see", "lme4"), quietly = TRUE))) withAutoprint({ # examplesIf
+ ## End(Don't show)
+ # ==============================================
+ # estimate_grouplevel
+ # ==============================================
+ ## Not run: 
+ ##D data <- lme4::sleepstudy
+ ##D data <- rbind(data, data)
+ ##D data$Newfactor <- rep(c("A", "B", "C", "D"))
+ ##D 
+ ##D # 1 random intercept
+ ##D model <- lme4::lmer(Reaction ~ Days + (1 | Subject), data = data)
+ ##D x <- estimate_grouplevel(model)
+ ##D layers <- visualisation_recipe(x)
+ ##D layers
+ ##D plot(layers)
+ ##D 
+ ##D # 2 random intercepts
+ ##D model <- lme4::lmer(Reaction ~ Days + (1 | Subject) + (1 | Newfactor), data = data)
+ ##D x <- estimate_grouplevel(model)
+ ##D plot(x) +
+ ##D   geom_hline(yintercept = 0, linetype = "dashed") +
+ ##D   theme_minimal()
+ ##D # Note: we need to use hline instead of vline because the axes is flipped
+ ##D 
+ ##D model <- lme4::lmer(Reaction ~ Days + (1 + Days | Subject) + (1 | Newfactor), data = data)
+ ##D x <- estimate_grouplevel(model)
+ ##D plot(x)
+ ## End(Not run)
+ ## Don't show: 
+ }) # examplesIf
> ## End(Don't show)
> 
> 
> 
> cleanEx()

detaching â€˜package:seeâ€™, â€˜package:ggplot2â€™

> nameEx("zero_crossings")
> ### * zero_crossings
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: zero_crossings
> ### Title: Find zero-crossings and inversion points
> ### Aliases: zero_crossings find_inversions
> 
> ### ** Examples
> 
> x <- sin(seq(0, 4 * pi, length.out = 100))
> # plot(x, type = "b")
> 
> modelbased::zero_crossings(x)
[1]  1.00000 25.74975 50.50000 75.25025
> modelbased::find_inversions(x)
[1] 12.87478 37.62484 62.37516 87.12522
> 
> 
> 
> ### * <FOOTER>
> ###
> cleanEx()
> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  16.607 0.826 14.408 0 0 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
