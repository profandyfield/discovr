---
title: "Labcoat Leni Solutions: Chapter 5"
author: "Andy P. Field"
date: 'Last updated `r format(Sys.Date(), "%d %B %Y")`'
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Labcoat Leni Solutions: Chapter 5}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  warning = FALSE,
  message = FALSE
)
```

```{r setup, echo=FALSE}
library(tidyverse)
oxoby_tib <- readr::read_csv("../data-raw/oxoby_2008.csv") %>% 
  dplyr::mutate(
    singer = forcats::as_factor(singer)
  )

johns_tib <- discovr::johns_2012
```
![](../data-raw/images/leni_banner.png)

> This document may contain abridged sections from *Discovering Statistics Using R and RStudio* by [Andy Field](https://www.discoveringstatistics.com/) so there are some copyright considerations, but the material is offered under a [Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License](http://creativecommons.org/licenses/by-nc-nd/4.0/). Basically you can use this material for teaching and non-profit activities but please do not meddle with it or claim it as your own work.

## Gonna be a rock ‘n’ roll singer (again!)

First, let's produce a histogram for the minimum acceptable offer data. Open the file and save it in a tibble called `oxoby_tib`. If you're working from the CSV file and you have set up your project in the way described in the book (with the CSV file in a folder called data and your markdown file in a folder called r_docs) then this code should read in the data and convert the variable **singer** to a factor:

```{r, eval = FALSE}
library(tidyverse)
oxoby_tib <- readr::read_csv("../data/oxoby_2008.csv") %>% 
  dplyr::mutate(
    singer = forcats::as_factor(singer)
  )
```

Alternative, load the data directly from the `discovr` package:

```{r, eval=FALSE}
library(discovr)
library(tidyverse)

oxoby_tib <- discovr::acdc
```

We can produce a plot of **mao** as follows:

```{r}
ggplot2::ggplot(oxoby_tib, aes(mao)) +
  geom_histogram(binwidth = 1, fill = "#56B4E9", colour = "#336c8b", alpha = 0.2) +
  labs(y = "Frequency", x = "Minimum Acceptable Offer", title = "Oxoby 2008 Figure 1 data") +
  scale_x_continuous(breaks = seq(0, 5, 1)) +
  facet_wrap(~singer) +
  theme_minimal()
```

We can compare the resulting population pyramid above with Figure 2 from the original article (below). Both graphs show that MAOs were higher when participants heard the music of Bon Scott. This suggests that more offers would be rejected when listening to Bon Scott than when listening to Brian Johnson.

![Oxoby (2008) Figure 2](../data-raw/images/ds_c05_leni_fig_01.png)

Next we want to produce a population pyramid for number of offers made. To do this, use this code (the only things that change are the *x*-variable in the first line and the label for the *x*-axis):

```{r}
ggplot2::ggplot(oxoby_tib, aes(offer)) +
  geom_histogram(binwidth = 1, fill = "#56B4E9", colour = "#336c8b", alpha = 0.2) +
  labs(y = "Frequency", x = "Offers made", title = "Oxoby 2008 Figure 1 data") +
  scale_x_continuous(breaks = seq(0, 5, 1)) +
  facet_wrap(~singer) +
  theme_minimal()
```

We can compare the resulting population pyramid above with Figure 1 from the original article (below). Both graphs show that offers made were lower when participants heard the music of Bon Scott.

![Oxoby (2008) Figure 1](../data-raw/images/ds_c05_leni_fig_02.png)

## Seeing red

Open the file and save it in a tibble called `johns_tib`. If you're working from the CSV file and you have set up your project in the way described in the book (with the CSV file in a folder called data and your markdown file in a folder called r_docs) then this code should read in the data and convert the variable **singer** to a factor:

```{r, eval = FALSE}
library(tidyverse)
johns_tib <- readr::read_csv("../data/johns_2012.csv") %>% 
  dplyr::mutate(
    singer = forcats::as_factor(singer)
  )
```

Alternative, load the data directly from the `discovr` package:

```{r, eval=FALSE}
library(discovr)
library(tidyverse)

johns_tib <- discovr::johns_2012
```

The plot can be made using the following code:

```{r}
ggplot2::ggplot(johns_tib, aes(colour, attractiveness)) +
  stat_summary(fun.data = "mean_cl_normal", geom = "pointrange") +
  labs(x = "Colour of genetalia", y = "Attractiveness rating (0 to 100)") +
  coord_cartesian(ylim = c(0, 50)) +
  scale_y_continuous(breaks = seq(0, 50, 5)) +
  theme_minimal()
```

The mean ratings for all colours are fairly similar, suggesting that men don't prefer the colour red. In fact, the colour red has the lowest mean rating, suggesting that men liked the red genitalia the least. The light pink genital colour had the highest mean rating, but don't read anything into that: the means are all very similar.